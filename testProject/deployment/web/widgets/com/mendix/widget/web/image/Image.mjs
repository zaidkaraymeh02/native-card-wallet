import e,{useState as n,useCallback as t,createElement as o,useRef as r,useEffect as i,forwardRef as a,useImperativeHandle as s,cloneElement as c}from"react";import l from"react-dom";var u,d={exports:{}};
/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/u=d,function(){var e={}.hasOwnProperty;function n(){for(var t=[],o=0;o<arguments.length;o++){var r=arguments[o];if(r){var i=typeof r;if("string"===i||"number"===i)t.push(r);else if(Array.isArray(r)){if(r.length){var a=n.apply(null,r);a&&t.push(a)}}else if("object"===i){if(r.toString!==Object.prototype.toString&&!r.toString.toString().includes("[native code]")){t.push(r.toString());continue}for(var s in r)e.call(r,s)&&r[s]&&t.push(s)}}}return t.join(" ")}u.exports?(n.default=n,u.exports=n):window.classNames=n}();var p=d.exports;function f(e,n){return"pixels"===n?e:"percentage"===n?e+"%":""}function h(e,n){return e?{onClick:e,role:"button",tabIndex:null!=n?n:0,onKeyDown:n=>{"Enter"!==n.key&&" "!==n.key||e(n)}}:{}}const m=function(e){return o("div",{className:p("mx-image-viewer",{"mx-image-viewer-responsive":e.responsive},e.className,{hidden:!e.hasImage})},e.children)},g=function(e){return o("div",{className:p("mx-image-viewer","mx-image-background",e.className),onClick:e.onClick,style:{...e.style,height:f(e.height,e.heightUnit),width:f(e.width,e.widthUnit),backgroundImage:"url('".concat(e.image,"')")}},e.children)},v=function(e){const n=e.altText?{"aria-label":e.altText,role:"img"}:{},t=h(e.onClick,e.tabIndex);return o("span",{className:p(e.icon,{glyphicon:e.isGlyph}),style:{...e.style,fontSize:"".concat(e.size,"px")},...n,...t})},y=function(e){const n=h(e.onClick,e.tabIndex);return o("img",{className:e.className,src:e.image,style:{...e.style,height:f(e.height,e.heightUnit),width:f(e.width,e.widthUnit)},alt:e.altText,...n})};function b(){return b=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},b.apply(this,arguments)}function x(e){return e&&e.ownerDocument||document}function w(e){void 0===e&&(e=x());try{var n=e.activeElement;return n&&n.nodeName?n:null}catch(n){return e.body}}function k(e,n){return e.contains?e.contains(n):e.compareDocumentPosition?e===n||!!(16&e.compareDocumentPosition(n)):void 0}var E=!("undefined"==typeof window||!window.document||!window.document.createElement),C=!1,O=!1;try{var N={get passive(){return C=!0},get once(){return O=C=!0}};E&&(window.addEventListener("test",N,N),window.removeEventListener("test",N,!0))}catch(e){}function T(e,n,t,o){return function(e,n,t,o){if(o&&"boolean"!=typeof o&&!O){var r=o.once,i=o.capture,a=t;!O&&r&&(a=t.__once||function e(o){this.removeEventListener(n,e,i),t.call(this,o)},t.__once=a),e.addEventListener(n,a,C?o:i)}e.addEventListener(n,t,o)}(e,n,t,o),function(){!function(e,n,t,o){var r=o&&"boolean"!=typeof o?o.capture:o;e.removeEventListener(n,t,r),t.__once&&e.removeEventListener(n,t.__once,r)}(e,n,t,o)}}var S,I,L,U,P={exports:{}};function F(e){var n,t,o=((t=r(n=e)).current=n,t);i((function(){return function(){return o.current()}}),[])}function _(e){var n=function(e){var n=r(e);return i((function(){n.current=e}),[e]),n}(e);return t((function(){return n.current&&n.current.apply(n,arguments)}),[n])}function D(e,n){e.classList?e.classList.add(n):function(e,n){return e.classList?!!n&&e.classList.contains(n):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+n+" ")}(e,n)||("string"==typeof e.className?e.className=e.className+" "+n:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+n))}function R(e,n){return e.replace(new RegExp("(^|\\s)"+n+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function j(e,n){e.classList?e.classList.remove(n):"string"==typeof e.className?e.className=R(e.className,n):e.setAttribute("class",R(e.className&&e.className.baseVal||"",n))}function A(e,n){return function(e){var n=x(e);return n&&n.defaultView||window}(e).getComputedStyle(e,n)}P.exports=function(){if(U)return L;U=1;var e=I?S:(I=1,S="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED");function n(){}function t(){}return t.resetWarningCache=n,L=function(){function o(n,t,o,r,i,a){if(a!==e){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function r(){return o}o.isRequired=o;var i={array:o,bigint:o,bool:o,func:o,number:o,object:o,string:o,symbol:o,any:o,arrayOf:r,element:o,elementType:o,instanceOf:r,node:o,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:t,resetWarningCache:n};return i.PropTypes=i,i}}()();var B=/([A-Z])/g;var M=/^ms-/;function z(e){return function(e){return e.replace(B,"-$1").toLowerCase()}(e).replace(M,"-ms-")}var V,H=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function W(e,n){var t="",o="";if("string"==typeof n)return e.style.getPropertyValue(z(n))||A(e).getPropertyValue(z(n));Object.keys(n).forEach((function(r){var i=n[r];i||0===i?!function(e){return!(!e||!H.test(e))}(r)?t+=z(r)+": "+i+";":o+=r+"("+i+") ":e.style.removeProperty(z(r))})),o&&(t+="transform: "+o+";"),e.style.cssText+=";"+t}function $(e){return"window"in e&&e.window===e?e:"nodeType"in(n=e)&&n.nodeType===document.DOCUMENT_NODE&&e.defaultView||!1;var n}function K(e){var n;return $(e)||(n=e)&&"body"===n.tagName.toLowerCase()?function(e){var n=$(e)?x():x(e),t=$(e)||n.defaultView;return n.body.clientWidth<t.innerWidth}(e):e.scrollHeight>e.clientHeight}var Y=["template","script","style"],G=function(e,n,t){[].forEach.call(e.children,(function(e){var o,r,i;-1===n.indexOf(e)&&(r=(o=e).nodeType,i=o.tagName,1===r&&-1===Y.indexOf(i.toLowerCase()))&&t(e)}))};function X(e,n){n&&(e?n.setAttribute("aria-hidden","true"):n.removeAttribute("aria-hidden"))}var Z,q=function(){function e(e){var n=void 0===e?{}:e,t=n.hideSiblingNodes,o=void 0===t||t,r=n.handleContainerOverflow,i=void 0===r||r;this.hideSiblingNodes=void 0,this.handleContainerOverflow=void 0,this.modals=void 0,this.containers=void 0,this.data=void 0,this.scrollbarSize=void 0,this.hideSiblingNodes=o,this.handleContainerOverflow=i,this.modals=[],this.containers=[],this.data=[],this.scrollbarSize=function(e){if((!V&&0!==V||e)&&E){var n=document.createElement("div");n.style.position="absolute",n.style.top="-9999px",n.style.width="50px",n.style.height="50px",n.style.overflow="scroll",document.body.appendChild(n),V=n.offsetWidth-n.clientWidth,document.body.removeChild(n)}return V}()}var n=e.prototype;return n.isContainerOverflowing=function(e){var n=this.data[this.containerIndexFromModal(e)];return n&&n.overflowing},n.containerIndexFromModal=function(e){return n=this.data,t=function(n){return-1!==n.modals.indexOf(e)},o=-1,n.some((function(e,n){return!!t(e,n)&&(o=n,!0)})),o;var n,t,o},n.setContainerStyle=function(e,n){var t={overflow:"hidden"};e.style={overflow:n.style.overflow,paddingRight:n.style.paddingRight},e.overflowing&&(t.paddingRight=parseInt(W(n,"paddingRight")||"0",10)+this.scrollbarSize+"px"),W(n,t)},n.removeContainerStyle=function(e,n){Object.assign(n.style,e.style)},n.add=function(e,n,t){var o=this.modals.indexOf(e),r=this.containers.indexOf(n);if(-1!==o)return o;if(o=this.modals.length,this.modals.push(e),this.hideSiblingNodes&&function(e,n){var t=n.dialog,o=n.backdrop;G(e,[t,o],(function(e){return X(!0,e)}))}(n,e),-1!==r)return this.data[r].modals.push(e),o;var i={modals:[e],classes:t?t.split(/\s+/):[],overflowing:K(n)};return this.handleContainerOverflow&&this.setContainerStyle(i,n),i.classes.forEach(D.bind(null,n)),this.containers.push(n),this.data.push(i),o},n.remove=function(e){var n=this.modals.indexOf(e);if(-1!==n){var t=this.containerIndexFromModal(e),o=this.data[t],r=this.containers[t];if(o.modals.splice(o.modals.indexOf(e),1),this.modals.splice(n,1),0===o.modals.length)o.classes.forEach(j.bind(null,r)),this.handleContainerOverflow&&this.removeContainerStyle(o,r),this.hideSiblingNodes&&function(e,n){var t=n.dialog,o=n.backdrop;G(e,[t,o],(function(e){return X(!1,e)}))}(r,e),this.containers.splice(t,1),this.data.splice(t,1);else if(this.hideSiblingNodes){var i=o.modals[o.modals.length-1],a=i.backdrop;X(!1,i.dialog),X(!1,a)}}},n.isTopModal=function(e){return!!this.modals.length&&this.modals[this.modals.length-1]===e},e}(),J=function(e){var n;return"undefined"==typeof document?null:null==e?x().body:("function"==typeof e&&(e=e()),e&&"current"in e&&(e=e.current),null!=(n=e)&&n.nodeType&&e||null)};function Q(e){var n=e||(Z||(Z=new q),Z),o=r({dialog:null,backdrop:null});return Object.assign(o.current,{add:function(e,t){return n.add(o.current,e,t)},remove:function(){return n.remove(o.current)},isTopModal:function(){return n.isTopModal(o.current)},setDialogRef:t((function(e){o.current.dialog=e}),[]),setBackdropRef:t((function(e){o.current.backdrop=e}),[])})}var ee=a((function(t,o){var a=t.show,c=void 0!==a&&a,u=t.role,d=void 0===u?"dialog":u,p=t.className,f=t.style,h=t.children,m=t.backdrop,g=void 0===m||m,v=t.keyboard,y=void 0===v||v,x=t.onBackdropClick,C=t.onEscapeKeyDown,O=t.transition,N=t.backdropTransition,S=t.autoFocus,I=void 0===S||S,L=t.enforceFocus,U=void 0===L||L,P=t.restoreFocus,D=void 0===P||P,R=t.restoreFocusOptions,j=t.renderDialog,A=t.renderBackdrop,B=void 0===A?function(n){return e.createElement("div",n)}:A,M=t.manager,z=t.container,V=t.containerClassName,H=t.onShow,W=t.onHide,$=void 0===W?function(){}:W,K=t.onExit,Y=t.onExited,G=t.onExiting,X=t.onEnter,Z=t.onEntering,q=t.onEntered,ee=function(e,n){if(null==e)return{};var t,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(t,["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","backdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","containerClassName","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"]),ne=function(e,t){var o=n((function(){return J(e)})),r=o[0],a=o[1];if(!r){var s=J(e);s&&a(s)}return i((function(){t&&r&&t(r)}),[t,r]),i((function(){var n=J(e);n!==r&&a(n)}),[e,r]),r}(z),te=Q(M),oe=function(){var e=r(!0),n=r((function(){return e.current}));return i((function(){return e.current=!0,function(){e.current=!1}}),[]),n.current}(),re=function(e){var n=r(null);return i((function(){n.current=e})),n.current}(c),ie=n(!c),ae=ie[0],se=ie[1],ce=r(null);s(o,(function(){return te}),[te]),E&&!re&&c&&(ce.current=w()),O||c||ae?c&&ae&&se(!1):se(!0);var le=_((function(){if(te.add(ne,V),me.current=T(document,"keydown",fe),he.current=T(document,"focus",(function(){return setTimeout(de)}),!0),H&&H(),I){var e=w(document);te.dialog&&e&&!k(te.dialog,e)&&(ce.current=e,te.dialog.focus())}})),ue=_((function(){var e;(te.remove(),null==me.current||me.current(),null==he.current||he.current(),D)&&(null==(e=ce.current)||null==e.focus||e.focus(R),ce.current=null)}));i((function(){c&&ne&&le()}),[c,ne,le]),i((function(){ae&&ue()}),[ae,ue]),F((function(){ue()}));var de=_((function(){if(U&&oe()&&te.isTopModal()){var e=w();te.dialog&&e&&!k(te.dialog,e)&&te.dialog.focus()}})),pe=_((function(e){e.target===e.currentTarget&&(null==x||x(e),!0===g&&$())})),fe=_((function(e){y&&27===e.keyCode&&te.isTopModal()&&(null==C||C(e),e.defaultPrevented||$())})),he=r(),me=r(),ge=O;if(!ne||!(c||ge&&!ae))return null;var ve=b({role:d,ref:te.setDialogRef,"aria-modal":"dialog"===d||void 0},ee,{style:f,className:p,tabIndex:-1}),ye=j?j(ve):e.createElement("div",ve,e.cloneElement(h,{role:"document"}));ge&&(ye=e.createElement(ge,{appear:!0,unmountOnExit:!0,in:!!c,onExit:K,onExiting:G,onExited:function(){se(!0);for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];null==Y||Y.apply(void 0,n)},onEnter:X,onEntering:Z,onEntered:q},ye));var be=null;if(g){var xe=N;be=B({ref:te.setBackdropRef,onClick:pe}),xe&&(be=e.createElement(xe,{appear:!0,in:!!c},be))}return e.createElement(e.Fragment,null,l.createPortal(e.createElement(e.Fragment,null,be,ye),ne))})),ne={show:P.exports.bool,container:P.exports.any,onShow:P.exports.func,onHide:P.exports.func,backdrop:P.exports.oneOfType([P.exports.bool,P.exports.oneOf(["static"])]),renderDialog:P.exports.func,renderBackdrop:P.exports.func,onEscapeKeyDown:P.exports.func,onBackdropClick:P.exports.func,containerClassName:P.exports.string,keyboard:P.exports.bool,transition:P.exports.elementType,backdropTransition:P.exports.elementType,autoFocus:P.exports.bool,enforceFocus:P.exports.bool,restoreFocus:P.exports.bool,restoreFocusOptions:P.exports.shape({preventScroll:P.exports.bool}),onEnter:P.exports.func,onEntering:P.exports.func,onEntered:P.exports.func,onExit:P.exports.func,onExiting:P.exports.func,onExited:P.exports.func,manager:P.exports.instanceOf(q)};ee.displayName="Modal",ee.propTypes=ne;var te=Object.assign(ee,{Manager:q}),oe="widgets/com/mendix/widget/web/image/assets/c021d926c33ac67c.svg";function re(e){let{onClose:n,...t}=e;return o("div",{className:"mx-image-viewer-lightbox-backdrop",...t},o("button",{className:p("btn btn-image btn-icon close-button"),onClick:n},o("img",{src:oe,className:"removeIcon",alt:"Close icon for the full screen image lightbox"})))}function ie(e){let{isOpen:n,onClose:r,children:i}=e;const a=t((e=>o(re,{onClose:r,...e})),[r]),s=t((e=>{e.stopPropagation()}),[]);return o(te,{show:n,onHide:r,renderBackdrop:a,onBackdropClick:s,className:"mx-image-viewer-lightbox"},o("div",null,i))}function ae(e,n){if(!e||"fullImage"===n)return e;const t=new URL(e);return t.searchParams.append("thumb","true"),t.href}const se=e=>{let{class:r,style:i,widthUnit:a,width:s,heightUnit:l,height:u,tabIndex:d,iconSize:f,responsive:h,onClickType:b,onClick:x,type:w,image:k,altText:E,displayAs:C,previewMode:O,renderAsBackground:N,backgroundImageContent:T}=e;const{lightboxIsOpen:S,openLightbox:I,closeLightbox:L}=(()=>{const[e,o]=n(!1);return{lightboxIsOpen:e,openLightbox:t((()=>{o(!0)}),[]),closeLightbox:t((()=>{o(!1)}),[])}})(),U=t((e=>{null==e||e.stopPropagation(),L()}),[L]),P=t((e=>{e.stopPropagation(),"action"===b?null==x||x():"enlarge"===b&&I()}),[x,b,I]),F={style:i,tabIndex:null!=d?d:0,onClick:"action"===b&&x||"enlarge"===b?P:void 0,altText:E},_="image"===w?o(y,{className:p({"img-thumbnail":"thumbnail"===C}),image:O?k:ae(k,C),height:u,heightUnit:l,width:s,widthUnit:a,...F}):o(v,{icon:k,isGlyph:"glyph"===w,size:f,...F});return N?o(g,{className:r,style:i,image:k,height:u,heightUnit:l,width:s,widthUnit:a,onClick:e=>{e.stopPropagation(),null==x||x()}},T):o(m,{className:r,responsive:h,hasImage:void 0!==k&&k.length>0},_,!O&&S&&o(ie,{isOpen:S,onClose:U},"image"===w?c(_,{image:k,onClick:void 0}):_))};const ce=e=>{var n;const r=t((()=>{var n;return null===(n=e.onClick)||void 0===n?void 0:n.execute()}),[e.onClick]),{type:i,image:a}=function(e){let{datasource:n,imageIcon:t,imageObject:o,imageUrl:r,defaultImageDynamic:i}=e;const a={type:"image",image:void 0};switch(n){case"image":return"available"===(null==o?void 0:o.status)?{type:"image",image:o.value.uri}:"unavailable"===(null==o?void 0:o.status)&&"available"===(null==i?void 0:i.status)?{type:"image",image:i.value.uri}:{type:"image",image:void 0};case"imageUrl":return{type:"image",image:"available"===(null==r?void 0:r.status)?r.value:void 0};case"icon":if("available"===(null==t?void 0:t.status)&&t.value){const e=t.value;return{type:e.type,image:"image"===e.type?e.iconUrl:e.iconClass}}return a;default:return a}}(e),s="available"===(null===(n=e.alternativeText)||void 0===n?void 0:n.status)?e.alternativeText.value:void 0;return o(se,{class:e.class,style:e.style,widthUnit:e.widthUnit,width:e.width,heightUnit:e.heightUnit,height:e.height,tabIndex:e.tabIndex,iconSize:e.iconSize,responsive:e.responsive,onClickType:e.onClickType,onClick:e.onClick?r:void 0,type:i,image:a,altText:s,displayAs:e.displayAs,renderAsBackground:"icon"!==e.datasource&&e.isBackgroundImage,backgroundImageContent:e.children})};export{ce as Image};
